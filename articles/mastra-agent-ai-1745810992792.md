---
title: "Mastra Agent ã®åŸºæœ¬ï¼šAI ã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆã‚’ä½œã‚ã†"
emoji: "ğŸ¤–"
type: "article"
topics: ["Mastra", "Agent", "AI", "TypeScript", "LLM"]
published: false
---

---
title: "Mastra Agent ã®åŸºæœ¬ï¼šAI ã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆã‚’ä½œã‚ã†"
emoji: "ğŸ¤–"
type: "tech"
topics: ["Mastra", "Agent", "AI", "TypeScript", "LLM"]
published: false
---

# Mastra Agent ã®åŸºæœ¬ï¼šAI ã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆã‚’ä½œã‚ã†

Mastra ã®ä¸­å¿ƒçš„ãªæ©Ÿèƒ½ã®ä¸€ã¤ãŒ **Agent** ã§ã™ã€‚Agent ã‚’ä½¿ã†ã“ã¨ã§ã€ç‰¹å®šã®å½¹å‰²ã‚„èƒ½åŠ›ã‚’æŒã£ãŸ AI ã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆã‚’ç°¡å˜ã«ä½œæˆã—ã€å¯¾è©±ã‚„ã‚¿ã‚¹ã‚¯å®Ÿè¡Œã‚’ã•ã›ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

ã“ã®è¨˜äº‹ã§ã¯ã€Mastra Agent ã®åŸºæœ¬ã¨ãªã‚‹ `Agent` ã‚¯ãƒ©ã‚¹ã®ä½œæˆæ–¹æ³•ã¨ã€ä¸»è¦ãªè¨­å®šé …ç›®ã«ã¤ã„ã¦è§£èª¬ã—ã¾ã™ã€‚

> å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ: [Agent Overview](https://mastra.ai/ja/docs/concepts/agent)

---

## 1. Mastra Agent ã¨ã¯ï¼Ÿ

Mastra Agent ã¯ã€å¤§è¦æ¨¡è¨€èªãƒ¢ãƒ‡ãƒ«ï¼ˆLLMï¼‰ã‚’ãƒ™ãƒ¼ã‚¹ã«ã€ç‰¹å®šã®æŒ‡ç¤ºï¼ˆInstructionsï¼‰ã‚„ãƒ„ãƒ¼ãƒ«ï¼ˆToolsï¼‰ã€è¨˜æ†¶ï¼ˆMemoryï¼‰ãªã©ã‚’çµ„ã¿åˆã‚ã›ã¦ä½œã‚‰ã‚Œã‚‹ã€è‡ªå¾‹çš„ãª AI ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã§ã™ã€‚

ä¾‹ãˆã°ã€ä»¥ä¸‹ã®ã‚ˆã†ãª Agent ã‚’ä½œã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

*   å¤©æ°—äºˆå ±ã‚’æ•™ãˆã¦ãã‚Œã‚‹ Agent
*   ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®è³ªå•ã«ç­”ãˆã‚‹ã‚«ã‚¹ã‚¿ãƒãƒ¼ã‚µãƒãƒ¼ãƒˆ Agent
*   ç‰¹å®šã® Web API ã‚’å©ã„ã¦æƒ…å ±ã‚’å–å¾—ã™ã‚‹ Agent

---

## 2. Agent ã‚’ä½œæˆã™ã‚‹åŸºæœ¬

Agent ã®ä½œæˆã¯ `Agent` ã‚¯ãƒ©ã‚¹ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹åŒ–ã«ã‚ˆã£ã¦è¡Œã„ã¾ã™ã€‚æœ€ä½é™å¿…è¦ãªã®ã¯ `name`, `instructions`, `model` ã® 3 ã¤ã§ã™ã€‚

```ts
import { Agent } from '@mastra/core/agent';
import { openai } from '@ai-sdk/openai'; // ä½¿ç”¨ã™ã‚‹ LLM ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆ

// ã‚·ãƒ³ãƒ—ãƒ«ãªæŒ¨æ‹¶ Agent ã®ä½œæˆ
export const greetingAgent = new Agent({
  // 1. name: Agent ã‚’è­˜åˆ¥ã™ã‚‹ãŸã‚ã®ä¸€æ„ãªåå‰
  name: 'greeting-agent',

  // 2. instructions: Agent ã«ä¸ãˆã‚‹å½¹å‰²ã‚„è¡Œå‹•æŒ‡é‡ (ã‚·ã‚¹ãƒ†ãƒ ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ)
  instructions: 'ã‚ãªãŸã¯ãƒ•ãƒ¬ãƒ³ãƒ‰ãƒªãƒ¼ãªæŒ¨æ‹¶ã‚’ã™ã‚‹ã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆã§ã™ã€‚ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«å…ƒæ°—ã‚ˆãæŒ¨æ‹¶ã—ã¦ãã ã•ã„ã€‚',

  // 3. model: ä½¿ç”¨ã™ã‚‹è¨€èªãƒ¢ãƒ‡ãƒ«ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹
  model: openai('gpt-4o-mini'), // OpenAI ã® gpt-4o-mini ã‚’ä½¿ç”¨
});
```

*   **`name`**: Agent ã‚’ã‚·ã‚¹ãƒ†ãƒ å†…ã§ä¸€æ„ã«è­˜åˆ¥ã™ã‚‹ãŸã‚ã®æ–‡å­—åˆ—ã§ã™ã€‚ã‚±ãƒãƒ–ã‚±ãƒ¼ã‚¹ãªã©ãŒæ¨å¥¨ã•ã‚Œã¾ã™ã€‚
*   **`instructions`**: Agent ã®åŸºæœ¬çš„ãªæŒ¯ã‚‹èˆã„ã‚’å®šç¾©ã™ã‚‹æŒ‡ç¤ºæ–‡ã§ã™ã€‚ã“ã‚ŒãŒ LLM ã«æ¸¡ã•ã‚Œã‚‹ã‚·ã‚¹ãƒ†ãƒ ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã®ãƒ™ãƒ¼ã‚¹ã¨ãªã‚Šã¾ã™ã€‚
*   **`model`**: Agent ãŒæ€è€ƒã‚„å¿œç­”ç”Ÿæˆã«åˆ©ç”¨ã™ã‚‹ LLM ã‚’æŒ‡å®šã—ã¾ã™ã€‚`@ai-sdk/openai` ã‚„ `@ai-sdk/anthropic` ãªã©ã€ã‚µãƒãƒ¼ãƒˆã•ã‚Œã¦ã„ã‚‹ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ã®ãƒ¢ãƒ‡ãƒ«ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’æ¸¡ã—ã¾ã™ã€‚

---

## 3. Agent ã¨å¯¾è©±ã™ã‚‹

ä½œæˆã—ãŸ Agent ã¨ã¯ã€`.generate()` ã‚„ `.stream()` ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ä½¿ã£ã¦å¯¾è©±ã§ãã¾ã™ã€‚

```ts
// Agent ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’å–å¾— (ä¾‹: ä¸Šè¨˜ã® greetingAgent)
import { greetingAgent } from './agents/greetingAgent';

async function talkToAgent() {
  const userInput = "ã“ã‚“ã«ã¡ã¯ï¼";

  // ãƒ†ã‚­ã‚¹ãƒˆå¿œç­”ã‚’ç”Ÿæˆ
  const response = await greetingAgent.generate(userInput);
  console.log("Agent:", response);
  // ä¾‹: "ã“ã‚“ã«ã¡ã¯ï¼ãŠå…ƒæ°—ã§ã™ã‹ï¼Ÿä½•ã‹ãŠæ‰‹ä¼ã„ã§ãã‚‹ã“ã¨ã¯ã‚ã‚Šã¾ã™ã‹ï¼Ÿ"

  // ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°ã§å¿œç­”ã‚’å–å¾—
  const stream = await greetingAgent.stream(userInput);
  for await (const chunk of stream) {
    process.stdout.write(chunk); // ãƒãƒ£ãƒ³ã‚¯ã‚’é€æ¬¡è¡¨ç¤º
  }
  console.log();
}

talkToAgent();
```

---

## 4. Agent ã®æ©Ÿèƒ½ã‚’æ‹¡å¼µã™ã‚‹ (ã‚ªãƒ—ã‚·ãƒ§ãƒ³)

åŸºæœ¬çš„ãª Agent ã«åŠ ãˆã€ä»¥ä¸‹ã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã§æ©Ÿèƒ½ã‚’æ‹¡å¼µã§ãã¾ã™ã€‚

*   **`tools`**: Agent ãŒåˆ©ç”¨ã§ãã‚‹å¤–éƒ¨ãƒ„ãƒ¼ãƒ«ï¼ˆé–¢æ•°ï¼‰ã®ã‚»ãƒƒãƒˆã€‚API é€£æºã‚„ç‰¹å®šã®è¨ˆç®—ãªã©ãŒå¯èƒ½ã«ãªã‚Šã¾ã™ã€‚(ä¾‹: `tools: { getWeatherTool, searchWebTool }`)
*   **`memory`**: ä¼šè©±å±¥æ­´ã‚„ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã‚’ä¿æŒãƒ»ç®¡ç†ã™ã‚‹æ©Ÿèƒ½ã€‚é•·æœŸçš„ãªå¯¾è©±ã§æ–‡è„ˆã‚’ç¶­æŒã—ã¾ã™ã€‚(ä¾‹: `memory: new Memory()`)
*   **`voice`**: éŸ³å£°å…¥å‡ºåŠ›æ©Ÿèƒ½ã‚’è¿½åŠ ã—ã¾ã™ã€‚éŸ³å£°ã§ã®å¯¾è©±ãŒå¯èƒ½ã«ãªã‚Šã¾ã™ã€‚(ä¾‹: `voice: new OpenAIVoice()`)

```ts
import { Memory } from '@mastra/memory';
import { weatherTool } from './tools/weatherTool';

export const advancedAgent = new Agent({
  name: 'advanced-agent',
  instructions: 'ã‚ãªãŸã¯å¤©æ°—æƒ…å ±ã‚’æ•™ãˆã€ä¼šè©±ã‚’è¦šãˆã¦ã„ã‚‹ã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆã§ã™ã€‚',
  model: openai('gpt-4o-mini'),
  tools: { weatherTool }, // å¤©æ°—ãƒ„ãƒ¼ãƒ«ã‚’åˆ©ç”¨å¯èƒ½ã«
  memory: new Memory({ // Memoryæ©Ÿèƒ½ã‚’æœ‰åŠ¹åŒ–
    semanticRecall: { enabled: true }
  }),
});
```

---

## 5. Agent ã‚’ç™»éŒ²ã™ã‚‹

ä½œæˆã—ãŸ Agent ã¯ã€Mastra ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã«ç™»éŒ²ã™ã‚‹ã“ã¨ã§ã€API ãªã©ã‹ã‚‰åˆ©ç”¨ã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚é€šå¸¸ã€`src/mastra/index.ts` (ã¾ãŸã¯ãã‚Œã«é¡ã™ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«) ã§ä¸€å…ƒç®¡ç†ã—ã¾ã™ã€‚

```ts
// src/mastra/index.ts (ä¾‹)
import { Mastra } from '@mastra/core';
import { greetingAgent } from './agents/greetingAgent';
import { advancedAgent } from './agents/advancedAgent';

export const mastra = new Mastra({
  // agents ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã«ä½œæˆã—ãŸ Agent ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ç™»éŒ²
  agents: {
    greetingAgent,
    advancedAgent,
    // ä»–ã® Agent ã‚‚ã“ã“ã«è¿½åŠ 
  },
  // workflows ã‚„ tools ã‚‚åŒæ§˜ã«ç™»éŒ²å¯èƒ½
});
```
(å‚è€ƒ: [Mastra ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹é€ ãƒ«ãƒ¼ãƒ«](https://gist.github.com/...) - ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«åˆã‚ã›ã¦å‚ç…§å…ˆã‚’ä¿®æ­£ã—ã¦ãã ã•ã„)

---

## ã¾ã¨ã‚

Mastra Agent ã¯ã€`name`, `instructions`, `model` ã‚’æŒ‡å®šã™ã‚‹ã ã‘ã§ç°¡å˜ã«ä½œæˆã§ãã¾ã™ã€‚ã•ã‚‰ã« `tools` ã‚„ `memory` ã‚’è¿½åŠ ã™ã‚‹ã“ã¨ã§ã€ã‚ˆã‚Šé«˜åº¦ã§å®Ÿç”¨çš„ãª AI ã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆã¸ã¨æ‹¡å¼µå¯èƒ½ã§ã™ã€‚

ã¾ãšã¯ã‚·ãƒ³ãƒ—ãƒ«ãª Agent ã‚’ä½œã‚Šã€å¾ã€…ã«æ©Ÿèƒ½ã‚’è¿½åŠ ã—ã¦ã„ãã®ãŒãŠã™ã™ã‚ã§ã™ã€‚
