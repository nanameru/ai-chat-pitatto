# コンポーネント変更履歴

## 2025-03-05
### multimodal-input.tsx
- 送信後の入力フィールドのリセット機能を改善
  - 送信ボタンをクリックした瞬間に入力フィールドがリセットされるように修正
  - 入力フィールドのリセットタイミングを送信完了後から送信開始時に変更
  - ユーザー体験を向上させるための即時フィードバック機能を実装

### 実装詳細
- `handleSubmitWithLogging`関数の先頭で入力フィールドをリセットするよう変更
- 現在の入力内容を一時変数に保存してからリセットし、その値をメッセージとして送信
- `submitForm`関数でも同様に即時クリアを実装
- 依存配列を適切に更新

### 関連する改善
- ユーザー体験の向上（送信ボタンクリック時に即座に入力フィールドがクリアされる）
- 操作の応答性向上（ユーザーアクションに対する即時フィードバック）
- 入力フィールドのリセットタイミングの最適化

## 2025-03-04
### messages.tsx
- メッセージの表示順序を修正
  - メッセージを単純に時系列順（createdAtの昇順）で表示するように変更
  - 標準的なチャットボットの表示ロジックに合わせて実装
  - ユーザーとAIのメッセージが交互に表示される自然な会話の流れを実現

### 実装詳細
- `useMemo`を使用して時系列順のソートを実装
- メッセージの`createdAt`タイムスタンプを基準に昇順で表示
- 余分な条件を削除し、シンプルで理解しやすいコードに変更

### 関連する改善
- 会話の流れが自然になり、ユーザー体験が向上
- 標準的なチャットUIの動作に合わせた一貫性のある表示
- シンプルなロジックによるコードの可読性と保守性の向上

## 2025-03-03
### multimodal-input.tsx
- ハイドレーションエラーを修正
  - `PureXSearchButton`コンポーネントを改善
  - クライアントサイドレンダリングとサーバーサイドレンダリングの一貫性を確保
  - `useState`と`useEffect`を使用して状態の初期化を適切に処理
  - `size-8`を`h-8 w-8`に変更してスタイルの一貫性を確保

### multimodal-input.tsx
- Deep Researchボタンのトグル機能を修正
  - ボタンを押しても通常チャットモードにしかならない問題を解決
  - ボタンの状態表示を親コンポーネントから渡される`isEnabled`プロパティに基づくように変更
  - ローカルステートの使用方法を最適化

### chat.tsx
- カスタムイベントのタイムスタンプ処理を修正
  - `new Date(timestamp).toLocaleTimeString()`から直接`timestamp`を使用するように変更
  - イベント処理の安定性を向上

### 実装詳細
- `PureXSearchButton`コンポーネントで`clientSideEnabled`状態の代わりに親から渡される`isEnabled`プロパティを使用
- ボタンクリック時の`setClientSideEnabled`呼び出しを削除し、親コンポーネントの状態更新に任せるように変更
- `handleXSearchToggle`関数でタイムスタンプ形式を`Date.now()`から`new Date().toLocaleTimeString()`に変更
- イベントハンドラーでタイムスタンプの処理方法を修正

### 関連する改善
- ボタンの状態管理の一貫性向上
- モード切替の信頼性向上
- UIとバックエンド状態の同期性改善
- デバッグ情報の可読性向上

## 2025-03-02
### multimodal-input.tsx
- ハイドレーションエラーを修正
  - `SendButton`と`StopButton`コンポーネントのクラス名を統一
  - `size-8`を`h-8 w-8`に変更して一貫性を確保
  - サーバーレンダリングとクライアントレンダリングの不一致を解消

## 2025-03-01
### app-sidebar.tsx
- サイドバーのタイトルを「Chatbot」から「Pitatto」に変更
- Pitattoロゴと文字の一体感を向上
  - ロゴと文字を共通のコンテナ内に配置
  - 背景色をサイドバーと同じ色（`bg-sidebar`）に統一
  - テキストカラーもサイドバーと同じ（`text-sidebar-foreground`）に統一
  - 角丸（rounded-lg）と影（shadow-sm）を追加
  - ロゴ自体も角丸（rounded-md）に設定
- `next/image`コンポーネントをインポートして画像を最適化表示
- ロゴサイズを28x28pxに拡大

### model-selector.tsx
- アイコンコンポーネントのプロップ修正
  - `ChevronDownIcon`と`CheckCircleFillIcon`の`className`プロップを`size`プロップに変更
  - TypeScriptの型エラーを解消
  - アイコンサイズを16pxに設定（`size={16}`）

### model-selector.tsx
- モデルセレクターのUIを簡素化
  - ドロップダウンのデザインを画像のようなシンプルなスタイルに変更
  - モデルバージョン表示を削除し、betaタグを追加
  - ドロップダウンメニューの幅を縮小（300px→220px）
  - 「Enable Search」オプションを追加
  - 選択中のモデルの視覚的フィードバックを改善

### multimodal-input.tsx
- ModelSelectorコンポーネントの配置を調整
  - クラス名を`h-8`から`mr-1`に変更して右マージンを追加
  - 送信ボタンとの間隔を最適化

### 関連する改善
- UIの簡素化と近代化
- ユーザーインターフェースの視認性向上
- モバイル表示の最適化
- 一貫したデザイン言語の適用

### chat-header.tsx
- 可視性セレクター（VisibilitySelector）を完全に非表示に変更
  - ヘッダーからVisibilitySelectorコンポーネントを削除
  - 不要なインポートを整理
  - コメントを追加して変更理由を明示

### 関連する改善
- UIの簡素化
- ヘッダーの視覚的な整理
- 不要な機能の削除によるユーザーインターフェースの明確化

### visibility-selector.tsx
- "Private"ボタンを非表示に変更
  - `visibilities`配列から'private'オプションを削除
  - 公開チャットのみを選択可能に変更
  - UIをシンプル化

### 関連する改善
- UIの簡素化
- ユーザーインターフェースの明確化
- 公開チャット機能の強調

### messages.tsx
- メッセージの表示順序を修正
  - ユーザーメッセージが常に上（先）に表示されるように変更
  - AIの回答が常に下（後）に表示されるように変更
  - メッセージを時系列順に並べ替え、同じタイムスタンプの場合はユーザーメッセージを優先
- `sortedMessages` 配列を追加して、メッセージを適切に並べ替え
- 並べ替えロジックを実装：
  1. 時間順（`createdAt`）に並べ替え
  2. 同じ時間の場合は、ユーザーメッセージを上に表示
  3. `createdAt`がない場合は元の順序を維持

## 2025-02-19
### chat-header.tsx
- Vercelデプロイボタンを削除
- レイアウトの調整とコードの整理

### multimodal-input.tsx
- IME入力中の確定時に誤送信されないように修正
- `handleKeyDown`関数を追加し、`isComposing`フラグを確認するように変更

### chat.tsx
- サジェスチョンの内容を日本語化
- AI関連の実用的なプロンプトに更新
- レイアウトのマージン調整

## コンポーネント構造
- `PureMessageActions`: メッセージのアクション（投票など）を処理
- `Suggestion`: サジェスチョンカードのUI表示
- `SuggestedActions`: 推奨アクションの一覧表示
- `MultimodalInput`: テキスト入力とファイル添付の処理
